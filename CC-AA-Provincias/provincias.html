<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<script>

    document.addEventListener("DOMContentLoaded", function () {

        var select = document.getElementById("comunidad");
        var selectCreate = document.createElement("select");
        select.addEventListener("change", function () {

            var xhr = new XMLHttpRequest();

            xhr.onreadystatechange = function () {
               
                if (this.readyState == 4 && this.status == 200) {
                var obj = JSON.parse(this.responseText);

                // Clear existing options in the select element before adding new ones 
                while (selectCreate.firstChild) {
                    selectCreate.removeChild(selectCreate.firstChild);
                }

                // Iterate through the object and create options for each key 
                for (const key of obj[select.value]) {
                    // console.log(key);
                    var option = document.createElement("option");
                    option.innerHTML = key;

                    selectCreate.appendChild(option);

                }

                // Append the new options to the DOM 
                document.body.appendChild(selectCreate);

            }

        };

            // Open and send the request 
            xhr.open("GET", "ccaa.json", true);
           // xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
            xhr.send(``);



        });

    }, false);



</script>

<body>

    <form>
        <label for='comunidad'>Comunidad autónoma: </label>
        <select id='comunidad'>
            <option value='' selected='selected'>--Elija una comunidad--</option>
            <option>andalucia</option>
            <option>aragon</option>
            <option>asturias</option>
            <option>baleares</option>
            <option>canarias</option>
            <option>cantabria</option>
            <option>castilla la mancha</option>
            <option>castilla y leon</option>
            <option>cataluña</option>
            <option>comunidad Valenciana</option>
            <option>extremadura</option>
            <option>galicia</option>
            <option>la rioja</option>
            <option>madrid</option>
            <option>navarra</option>
            <option>pais vasco</option>
            <option>murcia</option>
            <option>ceuta</option>
            <option>melilla</option>
        </select>

        <label for='provincias'>Provincias: </label>

    </form>

</body>

</html>